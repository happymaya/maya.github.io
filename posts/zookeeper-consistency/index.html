<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="ZooKeeper 的数据一致性" /><meta name="author" content="superhsc" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="ZooKeeper 如何保证数据一致性" /><meta property="og:description" content="ZooKeeper 如何保证数据一致性" /><link rel="canonical" href="/posts/zookeeper-consistency/" /><meta property="og:url" content="/posts/zookeeper-consistency/" /><meta property="og:site_name" content="ThinkerWalker" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-11-04T14:44:22+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="ZooKeeper 的数据一致性" /><meta name="twitter:site" content="@happymaya" /><meta name="twitter:creator" content="@superhsc" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"superhsc"},"dateModified":"2020-11-04T14:44:22+00:00","datePublished":"2020-11-04T14:44:22+00:00","description":"ZooKeeper 如何保证数据一致性","headline":"ZooKeeper 的数据一致性","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/zookeeper-consistency/"},"url":"/posts/zookeeper-consistency/"}</script><title>ZooKeeper 的数据一致性 | ThinkerWalker</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ThinkerWalker"><meta name="application-name" content="ThinkerWalker"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://images.happymaya.cn/assert/avatar/logo.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ThinkerWalker</a></div><div class="site-subtitle font-italic">日拱一卒 功不唐捐</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/happymaya" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/happymaya" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['haoshichuan','foxmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>ZooKeeper 的数据一致性</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>ZooKeeper 的数据一致性</h1><div class="post-meta text-muted"><div> 作者 <em> <a href="https://github.com/happymaya">superhsc</a> </em></div><div class="d-flex"><div> <span> 发表于 <em class="timeago" data-ts="1604501062" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2020-11-04 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2502 字"> <em>13 分钟</em>阅读</span></div></div></div><div class="post-content"><h1 id="zookeeper-如何保证数据一致性">ZooKeeper 如何保证数据一致性</h1><p>在分布式场景中，ZooKeeper 应用非常广泛，比如：</p><ul><li>数据发布和订阅<li>命名服务<li>配置中心<li>注册中心<li>分布式锁</ul><p>ZooKeeper 提供了一个类似 Linux 文件系统的数据模型，和基于 Watcher 机制的分布式事件通知，这些特性都依赖于 ZooKeeper 的高容错数据一致性协议。</p><h1 id="zab-一致性协议">Zab 一致性协议</h1><p>ZooKeeper 通过 Zab 协议保证分布式事务的最终一致性。</p><p>Zab（ZooKeeper Atomic Broadcast，ZooKeeper 原子广播协议）支持崩溃恢复。基于该协议，ZooKeeper 实现了一种主备模式的系统架构，来保持集群中各个副本之间数据一致性、</p><p>Zab 系统架构如下图：</p><p><img data-src="http://processon.com/chart_image/629275f7637689545dd857f1.png" alt="Zab 系统架构" data-proofer-ignore></p><p>在 ZooKeeper 集群中，所有客户端的请求都是写入到 Leader 进程中的，然后，由 Leader 同步到其他节点，称为 Follower。</p><p>在集群数据同步的过程中，如果出现 Follower 节点崩溃或者 Leader 进程崩溃时，都会通过 Zab 协议来保证数据一致性。</p><p>Zab 协议具体实现可以分为以下两个部分：</p><ul><li><p>消息广播阶段</p><p>Leader 节点接受事务提交，并将新的 Proposal 请求广播给 Follower 节点，收集各个节点的反馈，决定是否进行 Commit，在这个过程中，也会使用 Quorum 选举机制。</p><li><p>崩溃恢复阶段</p><p>如果在同步过程中出现 Leader 节点宕机，会进入崩溃恢复阶段，重新进行 Leader 选举，崩溃恢复阶段还包含数据同步操作，同步集群中最新的数据，保持集群的数据一致性。</p><p>整个 ZooKeeper 集群的一致性保证就是在上面两个状态之前切换：</p><ul><li>当 Leader 服务正常时，就是正常的消息广播模式；<li>当 Leader 不可用时，则进入崩溃恢复模式，崩溃恢复阶段会进行数据同步，完成以后，重新进入消息广播阶段。</ul></ul><h1 id="zab-协议中的-zxid">Zab 协议中的 Zxid</h1><p>Zxid 在 ZooKeeper 的一致性流程中非常重要。</p><p>Zxid 是 Zab 协议的一个事务编号。</p><p>Zxid 是一个 64 位的数字：</p><ul><li><p>低 32 位，是一个简单的<strong>单调递增计数器</strong>。针对客户端的每一个事务请求，计数器加 1；</p><li><p>高 32 位，代表 Leader 周期年代的变化。</p><p>Leader 周期的英文 epoch，可理解为<strong>当前集群所处的年代或者周期</strong>，对比 Raft 中的 Term 概念，在 Raft 中，每一个任期的开始都是一次选举，Raft 算法保证在给定的一个任期，最多只有一个领导人。</p><p><img data-src="http://processon.com/chart_image/6292809f637689545dd85a69.png" alt="64 位 Zxid" data-proofer-ignore></p></ul><p>Zab 协议的实现也类似（Raft 中的 Term），每当有一个新的 Leader 选举出现时，就会从这个 Leader 服务器上取出其本地日志中最大事务的 Zxid，并从中读取 epoch 值，然后加 1，以此作为新的周期 ID。总结一下，高 32 位代表了每代 Leader 的唯一性，低 32 位则代表了每代 Leader 中事务的唯一性。</p><h1 id="zab-流程">Zab 流程</h1><p>Zab 的具体流程可拆分为：<strong>消息广播</strong>、<strong>崩溃恢复（不对外服务，服务关闭）</strong>和<strong>数据同步</strong>三个过程。</p><h2 id="消息广播"><span class="mr-2">消息广播</span><a href="#消息广播" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>在 ZooKeeper 中所有的事务请求都由 Leader 节点来处理，其他服务器为 Follower，Leader 将客户端的事务请求转换为事务 Proposal，并且将 Proposal 分发给集群中其他所有的 Follower。</p><p>完成广播之后，Leader 等待 Follwer 反馈，当有过半数的 Follower 反馈信息后，Leader 将再次向集群内 Follower 广播 Commit 信息，Commit 信息就是确认将之前的 Proposal 提交。</p><p>这里的 Commit 可以对比 SQL 中的 COMMIT 操作来理解，MySQL 默认操作模式是 autocommit 自动提交模式，如果你显式地开始一个事务，在每次变更之后都要通过 COMMIT 语句来确认，将更改提交到数据库中。</p><p>Leader 节点的写入也是一个两步操作，第一步是广播事务操作，第二步是广播提交操作，其中过半数指的是反馈的节点数 &gt;=N/2+1，N 是全部的 Follower 节点数量。</p><p>消息广播的过程，如下图：</p><p><img data-src="http://processon.com/chart_image/629283f607912948154c7b72.png" alt="Zab 消息广播" data-proofer-ignore></p><ol><li>客户端的写请求进来之后，Leader 会将写请求包装成 Proposak 事务，并添加一个递增事务 ID，也就是 Zxid，Zxid 是单调递增的，以保证每个消息的先后顺序；<li>Proposal 事务，Leader 节点和 Follower 节点是解耦的，通信都会经过一个先进先出的消息队列，Leader 会为每一个 Follower 服务器分配一个单独的 FIFO 队列，而后把 Proposal 放到队列中；<li>Foller 节点收到对应的 Proposal 之后会把它持久到磁盘上，当完全写入之后，发一个 ACK 给 Leader；<li>Leader 收到超半数 Follower 机器的 ack 之后，会提交本地机器上的事务，同时开始广播 commit，Follwer 收到 commit 之后，完成各自的事务提交。</ol><h2 id="崩溃恢复选举的流程"><span class="mr-2">崩溃恢复（选举的流程）</span><a href="#崩溃恢复选举的流程" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p><strong>消息广播通过 Quorum 机制，解决了 Follower 节点宕机的情况。</strong></p><p>如果在广播过程中 Leader 节点崩溃，就需要 Zab 协议支持的崩溃恢复。</p><p><strong>崩溃恢复</strong>可以<strong>保证在 Leader 进程崩溃的时候可以重新选出 Leader，并且保证数据的完整性</strong>。</p><p>崩溃恢复和集群启动时的选举过程是一致的，也就是说，下面的几种情况都会进入崩溃恢复阶段：</p><ol><li>初始化集群，刚刚启动的时候；<li>Leader 崩溃，因为故障宕机；<li>Leader 失去了半数的机器支持，与集群中超过一半的节点断连</ol><p>崩溃恢复模式将会开启新的一轮选举，选举产生的 Leader 会与过半的 Follower 进行同步，使数据一致，当与过半的机器同步完成后，就退出恢复模式， 然后进入消息广播模式。</p><p>Zab 中的节点有三种状态，伴随着的 Zab 不同阶段的转换，节点状态也在变化：</p><div class="table-wrapper"><table><thead><tr><th>状态<th>说明<tbody><tr><td>following<td>当前节点是跟随者，服从Leader节点的命令<tr><td>leading<td>当前节点是Leader,负责协调事务<tr><td>election/looking<td>节点处于选举状态</table></div><p>栗子：假设正在运行的集群有五台 Follower 服务器，编号分别是 Server1、Server2、Server3、Server4、Server5，当前 Leader 是 Server2，若某一时刻 Leader 挂了，此时便开始 Leader 选举。</p><p>选举过程如下：</p><p><img data-src="http://processon.com/chart_image/629291f1e0b34d481b34684c.png" alt="崩溃恢复-选举的流程" data-proofer-ignore></p><ol><li><p>各个节点变更状态，变更为 Looking</p><p>ZooKeeper 中除了 Leader 和 Follower，还有 Observer 节点。</p><p>Observer 节点不参与选举，Leader 挂了之后，剩下的 Follower 节点都会将自己的状态变更为 Looking，而后开始进入 Leader 选举过程。</p><li><p>各个 Server 节点都发出一个投票，参与选举</p><p>在第一次投票中，所有的 Server 都会投自己（在初始阶段，每个节点不知道其他节点的zxid信息，也就是默认自己的最大，先投票给自己，经过一轮广播后，就有其他节点的信息了），而后各自将投票发送给集群中所有机器。</p><p>在运行期间，每个服务器上的 Zxid 大概率不同。</p><li><p>集群接收来自各个服务器的投票，并开始处理投票和选举</p><p>处理投票的过程对比 Zxid 的过程。</p><p>假设 Server3 的 Zxid 最大，Server 1 判断 Server3 可以成为 Leader，那么 Server1 就投票给 Server3，判断的依据如下：</p><ul><li>首先选举 epoch 最大的<li>如果 epoch 相等，则选 zxid 最大的<li>若 epoch 和 zxid 都相等，则选择 server id 最大的，就是配置 zoo.cfg 中的 myid</ul><p>在选举过程中，假如有节点获得超过半数的投票数，则会成为 Leader 节点，反之重新投票选举。</p><li><p>选举成功，修改服务器的状态</p></ol><h2 id="数据同步"><span class="mr-2">数据同步</span><a href="#数据同步" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>崩溃恢复完成选举以后，接下来就是数据同步。</p><p>在选举过程中，通过投票已经确认 Leader 服务器是最大Zxid 的节点，同步阶段就是利用 Leader 前一阶段获得的最新 Proposal 历史，同步集群中所有的副本。</p><h3 id="zab-与-paxos-算法的联系与区别"><span class="mr-2">Zab 与 Paxos 算法的联系与区别</span><a href="#zab-与-paxos-算法的联系与区别" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>Paxos 的思想在很多分布式组件中都可以看到，Zab 协议可以认为是<strong>基于 Paxos 算法实现的</strong>。</p><p>联系：</p><ol><li>都存在一个 Leader 进程的角色，负责协调多个 Follower 进程的运行；<li>都是 Quorum 机制的应用，Leader 进程都会等待超过半数的 Follower 做出正确的反馈后，才会将一个提案进行提交；<li>在 Zab 协议中，Zxid 中通过 epoch 来代表当前 Leader 周期，在 Paxos 算法中，同样存在这样一个标识，叫做 Ballot Number</ol><p>区别：</p><ol><li>Paxos 是理论，Zab 是实践；<li>Paxos 是论文性质的，目的是<strong>设计一种通用的分布式一致性算法</strong>；<li>Zab 协议应用在 ZooKeeper 中，是一个特别设计的、崩溃可恢复的、原子消息广播算法。</ol><p>Zab 协议增加了崩溃恢复的功能，当 Leader 服务器不可用，或者已经半数以上节点失去联系时，ZooKeeper 会进入恢复模式选举新的 Leader 服务器，使集群达到一个一致的状态。</p><p>参考资料：</p><p><a href="https://book.douban.com/subject/26292004/">《从Paxos到Zookeeper》</a></p><p><a href="https://book.douban.com/subject/26292004/">《ZooKeeper:分布式过程协同技术详解》</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/architecture-design/'>Architecture Design</a>, <a href='/categories/distributed/'>Distributed</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/distributed/" class="post-tag no-text-decoration" >distributed</a> <a href="/tags/zookeeper/" class="post-tag no-text-decoration" >ZooKeeper</a> <a href="/tags/zab/" class="post-tag no-text-decoration" >Zab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=ZooKeeper 的数据一致性 - ThinkerWalker&amp;url=/posts/zookeeper-consistency/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=ZooKeeper 的数据一致性 - ThinkerWalker&amp;u=/posts/zookeeper-consistency/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=/posts/zookeeper-consistency/&amp;text=ZooKeeper 的数据一致性 - ThinkerWalker" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/use-spring-security-to-build-a-user-authentication-system/">Spring Security 的配置体系</a><li><a href="/posts/spring-data-jpa-test/">利用单元测试和集成测试</a><li><a href="/posts/query-annotation/">Spring Data JPA - @Query</a><li><a href="/posts/defining-query-methods/">Spring Data JPA - Defining Query Methods 的命名语法与参数</a><li><a href="/posts/cache-redis-02/">Redis 的数据类型</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/thread/">thread</a> <a class="post-tag" href="/tags/jvm/">JVM</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a> <a class="post-tag" href="/tags/architecture-design/">Architecture Design</a> <a class="post-tag" href="/tags/backend-system/">Backend System</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/spring-security/">Spring Security</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/cache/">Cache</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CAP/"><div class="card-body"> <em class="timeago small" data-ts="1604327580" > 2020-11-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CAP</h3><div class="text-muted small"><p> 分布式系统技术是用来解决集中式架构的性能瓶颈问题，来适应快速发展的业务规模。 一般来说，分布式系统是建立在网络之上的硬件或者软件系统，彼此之间通过消息等方式进行通信和协调。 分布式系统的特点： 可扩展性，通过对服务、存储扩展，来提高系统的处理能力 不出现单点故障，单点故障（Single Poin Failure）指的是系统中某个组件一旦失效，会让这个系统无法工作。而不出现单点...</p></div></div></a></div><div class="card"> <a href="/posts/Paxos/"><div class="card-body"> <em class="timeago small" data-ts="1604327580" > 2020-11-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Paxos 算法</h3><div class="text-muted small"><p> Paxos 算法在分布式领域具有非常重要的地位。 开源分布式锁组件 Google Chuby 的作者 Mike Burrows 说过：这个世界上只有一种一致性算法——Paxos 算法，其他的算法都是残次品。 虽然 Paxos 算法很重要，但也因复杂而著名。 Quorum 机制 分布式系统中的 Quorum 选举算法。在各种一致性算法中都可以看到 Quorum 机制的身影。 Quor...</p></div></div></a></div><div class="card"> <a href="/posts/data-consistency-model/"><div class="card-body"> <em class="timeago small" data-ts="1604414662" > 2020-11-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Base 理论</h3><div class="text-muted small"><p> 对于 CAP 来说，放弃强一致性，追求分区容错性和可用性，是很多分布式设计时的选择。在工程实践中，基于 CAP 定理的逐步演化，提出了 Base 理论。 Base 理论 Base 是三个短语的简写，即： 基本可用 Basically Available 软状态 Soft State 最终一致性 Eventually Consistent Base 理论的核心思想是最终...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/data-consistency-model/" class="btn btn-outline-primary" prompt="上一篇"><p>Base 理论</p></a> <a href="/posts/consensus/" class="btn btn-outline-primary" prompt="下一篇"><p>共识问题</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/happymaya">superhsc</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/thread/">thread</a> <a class="post-tag" href="/tags/jvm/">JVM</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a> <a class="post-tag" href="/tags/architecture-design/">Architecture Design</a> <a class="post-tag" href="/tags/backend-system/">Backend System</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/spring-security/">Spring Security</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/cache/">Cache</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
