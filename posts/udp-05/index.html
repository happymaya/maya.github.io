<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="UDP 协议：TCP 协议和 UDP 协议的优势和劣势" /><meta name="author" content="superhsc" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="TCP 和 UDP 是今天应用最广泛的传输层协议，拥有最核心的垄断地位。" /><meta property="og:description" content="TCP 和 UDP 是今天应用最广泛的传输层协议，拥有最核心的垄断地位。" /><link rel="canonical" href="/posts/udp-05/" /><meta property="og:url" content="/posts/udp-05/" /><meta property="og:site_name" content="ThinkerWalker" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-07-05T12:32:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="UDP 协议：TCP 协议和 UDP 协议的优势和劣势" /><meta name="twitter:site" content="@happymaya" /><meta name="twitter:creator" content="@superhsc" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"superhsc"},"dateModified":"2018-07-05T12:32:00+00:00","datePublished":"2018-07-05T12:32:00+00:00","description":"TCP 和 UDP 是今天应用最广泛的传输层协议，拥有最核心的垄断地位。","headline":"UDP 协议：TCP 协议和 UDP 协议的优势和劣势","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/udp-05/"},"url":"/posts/udp-05/"}</script><title>UDP 协议：TCP 协议和 UDP 协议的优势和劣势 | ThinkerWalker</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="ThinkerWalker"><meta name="application-name" content="ThinkerWalker"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" https://images.happymaya.cn/assert/avatar/logo.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">ThinkerWalker</a></div><div class="site-subtitle font-italic">日拱一卒 功不唐捐</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/happymaya" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/happymaya" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['haoshichuan','foxmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>UDP 协议：TCP 协议和 UDP 协议的优势和劣势</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>UDP 协议：TCP 协议和 UDP 协议的优势和劣势</h1><div class="post-meta text-muted"><div> 作者 <em> <a href="https://github.com/happymaya">superhsc</a> </em></div><div class="d-flex"><div> <span> 发表于 <em class="timeago" data-ts="1530793920" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2018-07-05 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3468 字"> <em>19 分钟</em>阅读</span></div></div></div><div class="post-content"><p>TCP 和 UDP 是今天应用最广泛的传输层协议，拥有最核心的垄断地位。</p><ul><li>TCP 最核心的价值是提供了可靠性；<li>UDP 最核心的价值是灵活，几乎可以用它来做任何事情。例如：HTTP 协议 1.1 和 2.0 都基于 TCP，而到 HTTP 3.0 就开始用 UDP 了。</ul><p>如果打开 TCP 协议的 RFC文档，可以看到目录中一共有 85 页；如果你打开 UDP 的 RFC 文档，会看到目录中只有 3 页。一个只有 3 页的协议，能够成为今天最主流的传输层协议之一，那么它一定有非常值得学习的地方。</p><p>UDP 在数据传输、网络控制、音视频、Web 技术中，都有很重要的地位，因此它也是面试常考的内容。</p><p>设计系统时候，UDP 经常拿来和 TCP 比较。</p><h2 id="udp-协议"><span class="mr-2">UDP 协议</span><a href="#udp-协议" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>UDP（User Datagram Protocol），目标是<strong>在传输层提供直接发送报文（Datagram）的能力。</strong></p><p>Datagram 是数据传输的最小单位。UDP 协议不会帮助拆分数据，它的目标只有一个，就是发送报文。</p><p>有细心的同学可能会问： 为什么不直接调用 IP 协议呢？ 如果裸发数据，IP 协议不香吗？</p><p>这是因为传输层协议在承接上方应用层的调用，需要提供应用到应用的通信——因此要附上端口号。每个端口，代表不同的应用。传输层下层的 IP 协议，承接传输层的调用，将数据从主机传输到主机。IP 层不能区分应用，导致哪怕是在 IP 协议上进行简单封装，也需要单独一个协议。这就构成了 UDP 协议的市场空间。</p><h2 id="udp-的封包格式"><span class="mr-2">UDP 的封包格式</span><a href="#udp-的封包格式" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>UDP 的设计目标就是在允许用户直接发送报文的情况下，最大限度地简化应用的设计。下图是 UDP 的报文格式。</p><p><img data-src="https://images.happymaya.cn/assert/network/network-0501.png" alt="" data-proofer-ignore></p><p>UDP 的报文非常简化，只有 5 个部分：</p><ul><li>Source Port 是源端口号。因为 UDP 协议的特性（不需要 ACK），因此这个字段是可以省略的。但有时候对于防火墙、代理来说，Source Port 有很重要的意义，它们需要用这个字段行过滤和路由；<li>Destination Port 是目标端口号（这个字段不可以省略）；<li>Length 是消息体长度；<li>Checksum 是校验和，作用是检查封包是否出错；<li>Data octets 就是一个字节一个字节的数据，Octet 是 8 位。</ul><p><strong>校验和（Checksum）机制，</strong>这个机制在很多的网络协议中都会存在，因为校验数据在传输过程中有没有丢失、损坏是一个普遍需求。在一次网络会话中，传输的内容可能是：“你好！”，但事实上传输的是 01 组成的二进制。思考这样一个算法，把数据分成一个一个 byte，然后将所有 byte 相加，再将最终的结果取反。</p><p>比如现在数据有 4 个 byte：a,b,c,d，那么一种最简单的校验和就是：</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>checksum = (a+b+c+d) ^ 0xff
</pre></table></code></div></div><h2 id="udp-与-tcp的区别"><span class="mr-2">UDP 与 TCP的区别</span><a href="#udp-与-tcp的区别" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="目的差异"><span class="mr-2">目的差异</span><a href="#目的差异" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>这两个协议的目的不同：</p><ul><li>TCP 协议的核心目标是：提供可靠的网络传输；<li>UDP 协议的核心目标是：在提供报文交换能力基础上，尽可能地简化协议轻装上阵。</ul><h3 id="可靠性差异"><span class="mr-2">可靠性差异</span><a href="#可靠性差异" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>TCP 核心是要在保证可靠性提供更好的服务。TCP 会有握手的过程，需要建立连接，保证双方同时在线。而且TCP 有时间窗口持续收集无序的数据，直到这一批数据都可以合理地排序组成连续的结果；<li>UDP 并不具备以上这些特性，它只管发送数据封包，而且 UDP 不需要 ACK，这意味着消息发送出去成功与否 UDP 是不管的。</ul><h3 id="连接-vs-无连接"><span class="mr-2">连接 vs 无连接</span><a href="#连接-vs-无连接" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>TCP 是一个面向连接的协议（Connection-oriented Protocol），传输数据必须先建立连接；<li>UDP 是一个无连接协议（Connection-less Protocol），数据随时都可以发送，只提供发送封包（Datagram）的能力。</ul><h3 id="流控技术flow-control"><span class="mr-2">流控技术（Flow Control）</span><a href="#流控技术flow-control" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>TCP 使用了<strong>流控技术</strong>来确保发送方不会因为一次发送过多的数据包而使接收方不堪重负，TCP 在发送缓冲区中存储数据，并在接收缓冲区中接收数据。当应用程序准备就绪时，它将从接收缓冲区读取数据。如果接收缓冲区已满，接收方将无法处理更多数据，并将其丢弃；<li>UDP 没有提供类似的能力。</ul><h3 id="传输速度"><span class="mr-2">传输速度</span><a href="#传输速度" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><ul><li>UDP 协议简化，封包小，没有连接、可靠性检查等，因此单纯从传输速度上讲，UDP 更快。</ul><h3 id="场景差异"><span class="mr-2">场景差异</span><a href="#场景差异" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>TCP 每个数据封包都需要确认，因此天然不适应高速数据传输场景，比如观看视频（流媒体应用）、网络游戏（TCP 有延迟）等。</p><p>具体来说，如果网络游戏用 TCP，每个封包都需要确认，可能会造成一定的延迟；再比如音、视频传输天生就允许一定的丢包率；Ping 和 DNSLookup，这类型的操作只需要一次简单的请求/返回，不需要建立连接，用 UDP 就足够了。</p><p>近些年有一个趋势，TCP/UDP 的边界逐渐变得模糊，UDP 应用越来越多。比如传输文件，如果考虑希望文件无损到达，可以用 TCP。如果考虑希望传输足够块，就可能会用 UDP。再比如 HTTP 协议，如果考虑请求/返回的可靠性，用 TCP 比较合适。但是像 HTTP 3.0 这类应用层协议，从功能性上思考，暂时没有找到太多的优化点，但是想要把网络优化到极致，就会用 UDP 作为底层技术，然后在 UDP 基础上解决可靠性。</p><p><strong>所以理论上，任何一个用 TCP 协议构造的成熟应用层协议，都可以用 UDP 重构</strong>。这就好比，本来用一个工具可以解决所有问题，但是如果某一类问题体量非常大，就会专门为这类问题创造工具。因此，UDP 非常适合需要定制工具的场景。</p><p>场景分成三类：</p><ul><li>TCP 应用场景：<ul><li>远程控制（SSH）<li>File Transfer Protocol（FTP）<li>邮件（SMTP、IMAP）等<li>点对点文件传出（微信等）</ul><li>UDP 应用场景；<ul><li>网络游戏<li>音视频传输<li>DNS<li>Ping<li>直播</ul><li>模糊地带（TCP、UDP 都可以考虑）：<ul><li>HTTP（目前以 TCP 为主）<li>文件传输</ul></ul><p><strong>总之，UDP 不提供可靠性，不代表不能解决可靠性。UDP 的核心价值是灵活、轻量，构造了最小版本的传输层协议。在这个之上，还可以实现连接（Connection），实现会话（Session），实现可靠性（Reliability）……</strong></p><h2 id="总结"><span class="mr-2">总结</span><a href="#总结" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>协议对于我们来说是非常重要的，协议的制定让所有参与者一致、有序地工作。</p><p>学习协议的设计，对你的工作非常有帮助。比如：</p><ul><li>学习 TCP 协议可以培养你思维的缜密性——序号的设计、滑动窗口的设计、快速重发的设计、内在状态机的设计，都是非常精妙的想法；<li>学习 UDP 协议可以带动我们反思自己的技术架构，有时候简单的工具更受欢迎。Linux 下每个工具都是那么简单、专注，容易理解。相比 TCP 协议，UDP 更容易理解。</ul><p>从程序架构上来说，今天我们更倾向于简单专注的设计，我们更期望有解决报文传输的工具、有解决可靠性的工具、有解决流量控制的工具、有解决连接和会话的工具……我相信这应该是未来的趋势——由大量优质的工具逐渐取代历史上沉淀下来完整统一的系统。从这个角度，我希望通过学习传输层的知识，能够帮助你重新审视自己的系统设计，看看自己还有哪些进步的空间。</p><h3 id="tcp-协议和-udp-协议的优势和劣势"><span class="mr-2">TCP 协议和 UDP 协议的优势和劣势</span><a href="#tcp-协议和-udp-协议的优势和劣势" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>【<strong>解析</strong>】<strong>TCP 最核心的价值就是提供封装好的一套解决可靠性的优秀方案</strong>。 可以看到解决可靠性是非常复杂的，要考虑非常多的因素。TCP 在确保吞吐量、延迟、丢包率的基础上，保证可靠性。</p><p>历史上 TCP 也是靠可靠性起家的，有一次著名的实验，TCP 协议的设计者做了一次演示——利用 TCP 协议将数据在卫星和地面之间传播了很多次，没有发生任何数据损坏。从那个时候开始，研发人员开始大量选择 TCP 协议。然后随着生态的发展，逐渐提供了流控等能力。<strong>TCP 的成功在于它给人们提供了很多现成、好用的能力</strong>。</p><p><strong>UDP 则不同，UDP 提供了最小版的实现，只支持 Checksum</strong>。<strong>UDP 最核心的价值是灵活、轻量、传输速度快</strong>。</p><p>考虑到不同应用的特性，如果不使用一个大而全的方案，为自己的应用特性量身定做，可能会做得更好。比如网络游戏中游戏客户端不断向服务端发送玩家的位置，如果某一次消息丢失了，只要这个消息不影响最终的游戏结果，就可以只看下一个消息。不同应用有不同的特性，需要的可靠性级别不一样，这就是越来越多的应用开始使用 UDP 的原因之一。</p><p>其实对于我们来说，TCP 协议和 UDP 协议根本不存在什么优势和劣势，只不过是场景不同，选择不同而已。<strong>最后还有一个非常重要的考虑因素就是成本，如果没有足够专业的团队解决网络问题，TCP 无疑会是更好的选择</strong>。</p><h3 id="moba-类游戏的网络应该用-tcp-还是-udp"><span class="mr-2">Moba 类游戏的网络应该用 TCP 还是 UDP</span><a href="#moba-类游戏的网络应该用-tcp-还是-udp" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3></h3><p>所有在线联机游戏都有件非常重要的事情需要完成，就是<strong>确定事件发生的唯一性</strong>，这个性质和聊天工具是类似的。听我这么说，是不是有点迷？请听我慢慢道来。</p><p>你在王者荣耀中控制后羿释放技能，这是一个事件。同时，王昭君放了大招，这是第二个事件。两个事件一定要有先后顺序吗？答案是当然要有。因为游戏在同一时刻只能有一个状态。</p><p>类比一下，多个线程同时操作内存，发生了竞争条件（具体分析可以参见<a href="https://kaiwu.lagou.com/course/courseInfo.htm?courseId=478&amp;sid=20-h5Url-0&amp;buyFrom=2&amp;pageId=1pz4&amp;utm_source=zhuanlan article&amp;utm_medium=bottom&amp;utm_campaign=《计算机网络通关 29讲》专栏内嵌&amp;_channel_track_key=D2LoirKK#/content">《重学操作系统》</a>专栏关于“线程”的内容），那么是不是意味着，内存在同一时刻有两个状态呢？当然不是，<strong>内存同时刻只能有一个状态，所以多个线程的操作必须有先有后</strong>。</p><p>回到 Moba 游戏的问题，每个事件，游戏服务器必须给一个唯一的时序编号，对应后羿的技能和王昭君的技能。所以，在线竞技类游戏，事实上是玩家在不断向服务器竞争一个自增序列号的过程。无论客户端发生怎样的行为，只有竞争到自增 ID 才能进步。也就是说，<strong>服务器要尽快响应多个客户端提交的事件，并以最快的速度分配自增序号，然后返回给客户端</strong>。</p><p><strong>所以，Moba 服务端的核心是自增序号的计算和尽量缩减延迟</strong>。从这个角度出发，你再来看看，应该用 TCP 协议还是 UDP 协议呢？</p><p>虽然TCP 协议有 3 次握手，但是连接上之后，双方就不会再有额外的传输成本，因此创建连接的成本，可以忽略不计。</p><p>同时，TCP 协议还提供稳定性支持，不需要自己实现稳定性。如果规模较小的在线竞技类游戏，TCP 完全适用。但是当游戏玩家体量上升后，TCP 协议的头部（数据封包）较大，会增加服务器额外的 I/O 压力。要发送更多的数据，自然有更大的 I/O 压力。从这个角度来看，UDP 就有了用武之地。</p><p>经验：</p><ul><li>当你既要保证 FIFO，又要提供多处理的数据结构时，可以想到<strong>滑动窗口</strong>；<li>当你设计请求/响应模型的时，可以想到<strong>多路复用</strong>；<li>当你为自己的应用选择协议时，可以想到<strong>实现可靠性最基本的思路</strong>。</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/internal-power/'>Internal Power</a>, <a href='/categories/network/'>Network</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/udp/" class="post-tag no-text-decoration" >UDP</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=UDP 协议：TCP 协议和 UDP 协议的优势和劣势 - ThinkerWalker&amp;url=/posts/udp-05/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=UDP 协议：TCP 协议和 UDP 协议的优势和劣势 - ThinkerWalker&amp;u=/posts/udp-05/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=/posts/udp-05/&amp;text=UDP 协议：TCP 协议和 UDP 协议的优势和劣势 - ThinkerWalker" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" data-title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/use-spring-security-to-build-a-user-authentication-system/">Spring Security 的配置体系</a><li><a href="/posts/spring-data-jpa-test/">利用单元测试和集成测试</a><li><a href="/posts/query-annotation/">Spring Data JPA - @Query</a><li><a href="/posts/defining-query-methods/">Spring Data JPA - Defining Query Methods 的命名语法与参数</a><li><a href="/posts/cache-redis-02/">Redis 的数据类型</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/thread/">thread</a> <a class="post-tag" href="/tags/jvm/">JVM</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a> <a class="post-tag" href="/tags/architecture-design/">Architecture Design</a> <a class="post-tag" href="/tags/backend-system/">Backend System</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/spring-security/">Spring Security</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/cache/">Cache</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Honeycomb-mobile-network-01/"><div class="card-body"> <em class="timeago small" data-ts="1530450720" > 2018-07-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>漫游互联网：什么是蜂窝移动网络</h3><div class="text-muted small"><p> 从 DataReportal 2021 年 1 月的统计数据来看，全球 78 亿人口中，有 52 亿手机用户，46 亿互联网用户。 能够接入网络的设备越来越多，体量越来越大，这样一个庞大的世界是如何被构造出来的？ 思科（Cisco，世界 500 强通信设备提供商）在一篇报告中曾指出，2016 年年底全球 IP 流量超过 1 个 Zettabyte，也就是 1021 个字节，相当于一万亿 ...</p></div></div></a></div><div class="card"> <a href="/posts/tcp-02/"><div class="card-body"> <em class="timeago small" data-ts="1530534720" > 2018-07-02 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>传输层协议 TCP：TCP 为什么握手是 3 次、挥手是 4 次？</h3><div class="text-muted small"><p> TCP 和 UDP 是今天应用最广泛的传输层协议，拥有最核心的垄断地位。 今天互联网的整个传输层，几乎都是基于这两个协议打造的。无论是应用开发、框架设计选型、做底层和优化，还是定位线上问题，只要碰到网络，就逃不开 TCP 协议相关的知识。 在面试中 TCP 一直是一个高频考察内容，外加 TCP 关联的知识比较多，因此面试题五花八门。其中一道高频面试题：TCP 协议为什么握手是 3 次，挥...</p></div></div></a></div><div class="card"> <a href="/posts/tcp-packet-03/"><div class="card-body"> <em class="timeago small" data-ts="1530621120" > 2018-07-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TCP 的封包格式：TCP 为什么要粘包和拆包</h3><div class="text-muted small"><p> 从稳定性角度深挖 TCP 协议的运作机制。 如今，大半个互联网都建立在 TCP 协议之上，使用的 HTTP 协议、消息队列、存储、缓存，都需要用到 TCP 协议—— 这是因为 TCP 协议提供了可靠性。 简单来说，可靠性就是让数据无损送达。但若是考虑到成本，就会变得非常复杂 —— 因为还需要尽可能地提升吞吐量、降低延迟、减少丢包率。 TCP 协议具有很强的实用性，而可靠性又是 TCP ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/tcp-stability-04/" class="btn btn-outline-primary" prompt="上一篇"><p>TCP 的稳定性：滑动窗口和流速控制</p></a> <a href="/posts/nat-08/" class="btn btn-outline-primary" prompt="下一篇"><p>局域网：NAT 是如何工作的？</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/happymaya">superhsc</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/thread/">thread</a> <a class="post-tag" href="/tags/jvm/">JVM</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/">设计模式</a> <a class="post-tag" href="/tags/architecture-design/">Architecture Design</a> <a class="post-tag" href="/tags/backend-system/">Backend System</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/spring-security/">Spring Security</a> <a class="post-tag" href="/tags/springboot/">SpringBoot</a> <a class="post-tag" href="/tags/cache/">Cache</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/zh.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
